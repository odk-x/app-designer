<!doctype html>
<html>
	<head>
		<style>
textarea {
	min-width: 80%;
}
		</style>
		<script>
			var files = [];
			var ol = function ol() {
				redrawLeft();
			}
			var redrawLeft = function redrawLeft() {
				var left = document.getElementById("left")
				var elems = left.getElementsByTagName("input");
				var saved = -1;
				for (var i = 0; i < elems.length; i++) {
					if (elems[i].checked) saved = i;
				}
				left.innerHTML = ""
				for (var i = 0; i < files.length; i++) {
					var button = document.createElement("input")
					button.type = "radio";
					var id = "files-" + i.toString();
					button.id = id;
					button.name = "filelist";
					button.setAttribute("data-filename", files[i][0]);
					button.addEventListener("change", saveAndRedrawRight);
					button.checked = saved == i;
					var label = document.createElement("label")
					label.setAttribute("for", id);
					label.innerText = files[i][0];
					left.appendChild(button)
					left.appendChild(label)
					left.appendChild(document.createElement("br"))
				}
			}
			var redrawRight = function redrawRight(file) {
				var fields = []
				if (file[1] == "table") {
					fields = ["HTML", "CSS", "Js On Load", "Js Search", "Js Generic"];
				} else if (file[1] == "detail") {
					fields = ["HTML", "CSS", "Js On Load", "Js Generic"];
				} else if (file[1] == "index") {
					fields = ["Js", "CSS"];
				} else if (file[1] == "tabs") {
					fields = ["Js", "CSS"];
				} else if (file[1] == "graph") {
					fields = ["CSS", "Js"];
				}
				var right = document.getElementById("right");
				right.setAttribute("data-filename", file[0]);
				right.innerHTML = "";
				for (var i = 0; i < fields.length; i++) {
					var label = document.createTextNode(fields[i]);
					var box = document.createElement("textarea");
					var text_in_box = file[i + 2];
					box.value = text_in_box;
					var height = 20 * text_in_box.split("\n").length;
					box.style.minHeight = height.toString() + "px";
					box.setAttribute("data-index", i + 2);
					right.appendChild(label);
					right.appendChild(document.createElement("br"));
					right.appendChild(box);
					right.appendChild(document.createElement("br"));
				}
			}
			var getRight = function getRight() {
				var right = document.getElementById("right");
				if (!right.hasAttribute("data-filename")) return; // nothing to get
				var filename = right.getAttribute("data-filename");
				var found = -1;
				for (var i = 0; i < files.length; i++) {
					if (files[i][0] == filename) {
						found = i;
						break;
					}
				}
				if (found == -1) {
					alert("File not found");
					return;
				}
				var fields = right.getElementsByTagName("textarea");
				for (var i = 0; i < fields.length; i++) {
					var index = Number(fields[i].getAttribute("data-index"));
					files[found][index] = fields[i].value;
				}
			}
			var saveAndRedrawRight = function saveAndRedrawRight() {
				getRight();
				var left = document.getElementById("left")
				var elems = left.getElementsByTagName("input")
				for (var i = 0; i < elems.length; i++) {
					if (elems[i].checked) {
						for (var j = 0; j < files.length; j++) {
							if (files[j][0] == elems[i].getAttribute("data-filename")) {
								redrawRight(files[j]);
								return;
							}
						}
					}
				}
				alert("Filename not found in left");
			}
			var addFile = function addFile(filename, type) {
				if (filename.length == 0) {
					alert("Filename is empty!");
					return;
				}
				for (var i = 0; i < files.length; i++) {
					if (files[i][0] == filename) {
						alert("A file with that name already exists");
						return;
					}
				}
				files = files.concat(0)
				files[files.length - 1] = [filename, type]
				if (type == "table") {
					files[files.length - 1] = files[files.length - 1].concat(["", "", "", "", ""]) // customHtml, customCss, customJsOl, customJsSearch, customJsGeneric
				} else if (type == "detail") {
					files[files.length - 1] = files[files.length - 1].concat(["", "", "", ""]) // customHtml, customCss, customJsOl, customJsGeneric
				} else if (type == "index") {
					files[files.length - 1] = files[files.length - 1].concat(["", ""]) // customJs, customCss
				} else if (type == "tabs") {
					files[files.length - 1] = files[files.length - 1].concat(["", ""]) // customJs, customCss
				} else if (type == "graph") {
					files[files.length - 1] = files[files.length - 1].concat(["", ""]) // customCss, customJs
				} else {
					alert("unknown file type: " + type)
				}
				redrawLeft();
			}
			var add = function add() {
				addFile(document.getElementById("filename").value, document.getElementById("type").selectedOptions[0].value)
			}
		</script>
	</head>
	<body onLoad='ol();'>
		<input type='text' id='filename' />
		<select id='type'>
			<option value='table'>List View</option>
			<option value='detail'>Detail View</option>
			<option value='index'>Menu</option>
			<option value='tabs'>Tabs</option>
			<option value='graph'>Graph</option>
		</select>
		<button onClick="add();">Add file</button>
		<div id="left">
		</div>
		<div id="right">
		</div>
	</body>
</html>

