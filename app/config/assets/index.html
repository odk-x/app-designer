
<!doctype html>
<html>
	<head>
		<script type="text/javascript" src="/coldchain/system/js/odkCommon.js"></script>
		<script type="text/javascript" src="/coldchain/system/js/odkData.js"></script>
		<script type="text/javascript" src="/coldchain/system/tables/js/odkTables.js"></script>
		<script type="text/javascript" src="formgen_common.js"></script>
		<script type="text/javascript" src="generate_common.js"></script>
		<link href="generate_index.css" rel="stylesheet" />
		<style>
		
body {
	background: url('/coldchain/config/assets/img/hallway.jpg') no-repeat center/cover fixed;
}
		</style>
		<script>
			var metadata = {};
			var list_views = {};
			var menu = ["Empty menu!", null, []];
			// BEGIN CONFIG
			
list_views = {
	"health_facility": "config/assets/aa_health_facility_list.html",
	"refrigerators": "config/assets/aa_refrigerators_list.html",
	"refrigerator_types": "config/assets/aa_refrigerator_types_list.html",
}
menu = ["PATH Cold Chain Demo", null, [["Central", null, [["Central East", null, [["Filter By Type", "_html", "config/assets/admin_region_filter.html#Central East:"], ["Dowa", "_html", "config/assets/admin_region.html#Dowa:"], ["Kasungu", "_html", "config/assets/admin_region.html#Kasungu:"], ["Nkhotakota", "_html", "config/assets/admin_region.html#Nkhotakota:"], ["Ntchisi", "_html", "config/assets/admin_region.html#Ntchisi:"], ["Salima", "_html", "config/assets/admin_region.html#Salima:"]]], ["Central West", null, [["Filter By Type", "_html", "config/assets/admin_region_filter.html#Central West:"], ["Dedza", "_html", "config/assets/admin_region.html#Dedza:"], ["Lilongwe", "_html", "config/assets/admin_region.html#Lilongwe:"], ["Mchinji", "_html", "config/assets/admin_region.html#Mchinji:"], ["Ntcheu", "_html", "config/assets/admin_region.html#Ntcheu:"]]]]], ["North", null, [["Filter By Type", "_html", "config/assets/admin_region_filter.html#North:"], ["Chitipa", "_html", "config/assets/admin_region.html#Chitipa:"], ["Karonga", "_html", "config/assets/admin_region.html#Karonga:"], ["Likoma", "_html", "config/assets/admin_region.html#Likoma:"], ["Mzimba North", "_html", "config/assets/admin_region.html#Mzimba North:"], ["Mzimba South", "_html", "config/assets/admin_region.html#Mzimba South:"], ["Nkhata Bay", "_html", "config/assets/admin_region.html#Nkhata Bay:"], ["Rumphi", "_html", "config/assets/admin_region.html#Rumphi:"]]], ["South", null, [["South East", null, [["Filter By Type", "_html", "config/assets/admin_region_filter.html#South East:"], ["Balaka", "_html", "config/assets/admin_region.html#Balaka:"], ["Machinga", "_html", "config/assets/admin_region.html#Machinga:"], ["Mangochi", "_html", "config/assets/admin_region.html#Mangochi:"], ["Mulanje", "_html", "config/assets/admin_region.html#Mulanje:"], ["Phalombe", "_html", "config/assets/admin_region.html#Phalombe:"], ["Zomba", "_html", "config/assets/admin_region.html#Zomba:"]]], ["South West", null, [["Filter By Type", "_html", "config/assets/admin_region_filter.html#South West:"], ["Blantyre", "_html", "config/assets/admin_region.html#Blantyre:"], ["Chikwawa", "_html", "config/assets/admin_region.html#Chikwawa:"], ["Chiladzulu", "_html", "config/assets/admin_region.html#Chiladzulu:"], ["Mwanza", "_html", "config/assets/admin_region.html#Mwanza:"], ["Neno", "_html", "config/assets/admin_region.html#Neno:"], ["Nsanje", "_html", "config/assets/admin_region.html#Nsanje:"], ["Thyolo", "_html", "config/assets/admin_region.html#Thyolo:"]]]]], ["All Regions", null, [["Dowa", "_html", "config/assets/admin_region.html#Dowa:"], ["Kasungu", "_html", "config/assets/admin_region.html#Kasungu:"], ["Nkhotakota", "_html", "config/assets/admin_region.html#Nkhotakota:"], ["Ntchisi", "_html", "config/assets/admin_region.html#Ntchisi:"], ["Salima", "_html", "config/assets/admin_region.html#Salima:"], ["Dedza", "_html", "config/assets/admin_region.html#Dedza:"], ["Lilongwe", "_html", "config/assets/admin_region.html#Lilongwe:"], ["Mchinji", "_html", "config/assets/admin_region.html#Mchinji:"], ["Ntcheu", "_html", "config/assets/admin_region.html#Ntcheu:"], ["Chitipa", "_html", "config/assets/admin_region.html#Chitipa:"], ["Karonga", "_html", "config/assets/admin_region.html#Karonga:"], ["Likoma", "_html", "config/assets/admin_region.html#Likoma:"], ["Mzimba North", "_html", "config/assets/admin_region.html#Mzimba North:"], ["Mzimba South", "_html", "config/assets/admin_region.html#Mzimba South:"], ["Nkhata Bay", "_html", "config/assets/admin_region.html#Nkhata Bay:"], ["Rumphi", "_html", "config/assets/admin_region.html#Rumphi:"], ["Balaka", "_html", "config/assets/admin_region.html#Balaka:"], ["Machinga", "_html", "config/assets/admin_region.html#Machinga:"], ["Mangochi", "_html", "config/assets/admin_region.html#Mangochi:"], ["Mulanje", "_html", "config/assets/admin_region.html#Mulanje:"], ["Phalombe", "_html", "config/assets/admin_region.html#Phalombe:"], ["Zomba", "_html", "config/assets/admin_region.html#Zomba:"], ["Blantyre", "_html", "config/assets/admin_region.html#Blantyre:"], ["Chikwawa", "_html", "config/assets/admin_region.html#Chikwawa:"], ["Chiladzulu", "_html", "config/assets/admin_region.html#Chiladzulu:"], ["Mwanza", "_html", "config/assets/admin_region.html#Mwanza:"], ["Neno", "_html", "config/assets/admin_region.html#Neno:"], ["Nsanje", "_html", "config/assets/admin_region.html#Nsanje:"], ["Thyolo", "_html", "config/assets/admin_region.html#Thyolo:"]]], ["View Data", null, [["View Health Facilities", null, [["Search By Name/ID", "health_facility", ""]]], ["View Inventory", null, [["Refrigerator Age", "_html", "config/assets/inv_by_age.html"], ["Facility Grid Power Availability", "_html", "config/assets/inv_by_grid_power.html"]]], ["View Refrigerator Models", "refrigerator_types", "equipment_type"], ["More Options", null, [["View Health Facilities", "health_facility", [["View All", "health_facility", ""], [true, "health_facility", "admin_region"], [true, "health_facility", "facility_type"], ["Ownership", "health_facility", "facility_ownership"], ["More", "health_facility", [[true, "health_facility", "delivery_type"], [true, "health_facility", "electricity_source"], [true, "health_facility", "storage_type"], [true, "health_facility", "solar_suitable_climate"], [true, "health_facility", "solar_suitable_site"], [true, "health_facility", "vaccine_supply_mode"], ["By Reserve Stock Requirement", "health_facility", "vaccine_reserve_stock_requirement"]]]]], ["View Refrigerators", "refrigerators", [["View All", "refrigerators", ""], ["By Facility", "refrigerators", "facility_name"], ["By Model", "refrigerators", "catalog_id"], [true, "refrigerators", "year"], ["More", "refrigerators", [["By Use", "refrigerators", "utilization"], [true, "refrigerators", "working_status"], [true, "refrigerators", "reason_not_working"]]]]], ["View Refrigerator Models", "refrigerator_types", [["View All", "refrigerator_types", ""], [true, "refrigerator_types", "manufacturer"], [true, "refrigerator_types", "equipment_type"], ["More", "refrigerator_types", [[true, "refrigerator_types", "climate_zone"]]]]]]]]]]];
var addhf = function addhf() {
	odkTables.addRowWithSurvey(null, "health_facility", "health_facility", null, null);
}
var addrf = function addrf() {
	odkTables.addRowWithSurvey(null, "refrigerators", "refrigerators", null, null);
}
menu[2] = menu[2].concat(0);
menu[2][menu[2].length - 1] = ["Administrative Actions", null, [
		["Add Health Facility", "_js", addhf],
		//["Add Refrigerator", "_js", addrf]
	]]

if (window.location.hash.substr(1).length == 0) {
	var region_as_role = "";
	var all_regions = [];
	var rolesDone = regionsDone = false;
	var redirect = function redirect() {
		if (!(rolesDone && regionsDone)) return;
		var region = "";
		for (var i = 0; i < all_regions.length; i++) {
			if (region_as_role.toUpperCase() == all_regions[i].toUpperCase()) {
				region = all_regions[i];
			}
		}
		if (region.length == 0) {
			menu = [_tu("Error - Admin region ? does not exist or has no health facilities", region_as_role), null, []];
		}
		var html = "config/assets/admin_region.html#" + region + ":";
		window.location.href = "/coldchain/" + html
		//odkTables.launchHTML(null, html);
	}
	odkData.arbitraryQuery("health_facility", "SELECT DISTINCT admin_region FROM health_facility", [], 10000, 0, function(d) {
		for (var i = 0; i < d.getCount(); i++) {
			all_regions = all_regions.concat(d.getData(i, "admin_region"));
		}
		regionsDone = true;
		redirect();
	}, function(e) {
		alert(e);
	});
	odkData.getRoles(function(r) {
		r = r.resultObj.metadata.roles
		for (var i = 0; i < r.length; i++) {
			if (r[i].indexOf("GROUP_ADMIN_REGION_") == 0) {
				var region = r[i].replace("GROUP_ADMIN_REGION_", "");
				// replace all occurrences
				region = region.replace(/_/g, " ");
				region_as_role = region;
				menu = [_tu("Loading..."), null, []]
				doMenu();
				rolesDone = true;
				redirect();
				break;
			}
		}
	});
}
		
			// END CONFIG
		</script>
		<script src="generate_index.js"></script>
	</head>
	<body onLoad='ol();'>
		<div id="title" class="button"></div>
		<div id="list"></div>
	</body>
</html>
	